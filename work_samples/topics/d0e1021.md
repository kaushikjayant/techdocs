# PM Solution Installation {#d0e1021}

The deploy-proptima.sh script deploys

-   The NIMS PM Database schema
-   Base OMC VTIs
-   The user and privileges required to run the SIT

**Configuration Preparation**

-   Mediation Engine Configuration:

Refer to your deployment Infrastructure & Dimensioning inputs to choose the way mediation engine will be deployed.

â†’ Default :

```
touch <deploy-site>/config/eaa-proptima-mediation.env
```

-\> "etlnode" :

```
touch <deploy-site>/config/eaa-proptima-mediation-etlnode.env
```

To prepare deployment, you can go through [EAA ETL NODE mode activation](appx_etl_node_mode_activation.md).

-   Configuration completion:

Refer to [Preparing Configuration](appendix_prop.md) using the following dryrun cmd:

```
./eaa-proptima/shell/deploy-proptima.sh --dryrun
```

 

**PrOptima Services deployment**

-   Go to <root\_git\_dir\> directory in terminal and execute the following commands:
-   In case of a fresh/first time installation:

```
./eaa-proptima/shell/deploy-proptima.sh  --freshinstall
```

**Note :**

In order to create the db users / roles and OAuth Json files, Please do the following:

-   Connect to the prepare-db pod \( eaa-proptima-prepare-db-pm for Proptima and eaa-proptima-prepare-db-proassure for ProAssure\) using the following command

    ```
    oc rsh <eaa-proptima-prepare-db-<name>>
    ```

-   Go to the directory **/opt/mycom/proptima/proptima-deploy** 

    ```
    cd /opt/mycom/proptima/proptima-deploy
    ```

-   Run the following command:

    ```
    ./StartProptimaPrepareDb.sh
    ```

-   Deploy all PrOptima:

    ```
    ./eaa-proptima/shell/deploy-proptima.sh  --proceed
    ```

-   Ensure Deployment is complete and successful:

    ```
    ./eaa-deploy/shell/waitEndOfDeployment.sh
    ```

-   When finished, check status:

    ```
    python ./eaa-deploy/shell/check-deployment-status.py
    ```


**Checks**

Wait for all deployments to finish :

```
./eaa-deploy/shell/waitEndOfDeployment.sh
```

When finished, check status:

```
python ./eaa-deploy/shell/check-deployment-status.py
```

**Note:** It will deploy 1 PrOptipoller.

If you need to install other proptipollers, then run the following command:

```
oc process -f eaa-proptima/template/tpl-eaa-proptima-proptipoller.yaml --param-file eaa-deploy-site-<customer-project>/config/eaa-proptima-proptipoller.env -p PROPTIPOLLER_INDEX=<your index> | oc apply -f -
```

For example:

```
oc process -f eaa-proptima/template/tpl-eaa-proptima-proptipoller.yaml --param-file eaa-deploy-site-<customer-project>/config/eaa-proptima-proptipoller.env -p PROPTIPOLLER_INDEX=2 | oc apply -f -
```

**Running the System Integration Tests upon Deployment**

**Content**

The deploy-proptima.sh script also runs System Integration Tests for proptima

```
Checks
```

Run the following command

```
  oc get pods | grep sit
```

and the 6 sit pods running.

The SIT reports are accessible through HTTP.

To find the hosts, you can request for those reports, just execute the following command:

```
oc describe route | grep sit | grep Host
```

